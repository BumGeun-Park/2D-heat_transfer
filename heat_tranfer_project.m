t1=6; t14=6; t27=6; t40=6; t53=6; t66=6; t79=6; t92=6;
t105=6; t118=6; t131=6; t144=6; t157=6;   %boundary condition T1=6

t85=3; 	t86=3;	t87=3;	t88=3;	t89=3;	t90=3; t91=3;
t98=3;	t99=3;	t100=3; t101=3; t102=3; t103=3; t104=3;
t111=3; t112=3; t113=3; t114=3; t115=3; t116=3; t117=3;
t124=3; t125=3; t126=3; t127=3; t128=3; t129=3; t130=3;
t137=3; t138=3; t139=3; t140=3; t141=3; t142=3; t143=3;
t150=3; t151=3; t152=3; t153=3; t154=3; t155=3; t156=3;
t158=3; t159=3; t160=3; t161=3; t162=3;
t163=3; t164=3; t165=3; t166=3; t167=3; t168=3; t169=3;
%boundary condition T2=3

t0=0; %Infinite temperature

t2=0;t3=0;t4=0;t5=0;t6=0;t7=0;t8=0;t9=0;t10=0;t11=0;t12=0;t13=0;
t15=0;t16=0;t17=0;t18=0;t19=0;t20=0;t21=0;t22=0;t23=0;t24=0;t25=0;t26=0;
t28=0;t29=0;t30=0;t31=0;t32=0;t33=0;t34=0;t35=0;t36=0;t37=0;t38=0;t39=0;
t41=0;t42=0;t43=0;t44=0;t45=0;t46=0;t47=0;t48=0;t49=0;t50=0;t51=0;t52=0;
t54=0;t55=0;t56=0;t57=0;t58=0;t59=0;t60=0;t61=0;t62=0;t63=0;t64=0;t65=0;
t67=0;t68=0;t69=0;t70=0;t71=0;t72=0;t73=0;t74=0;t75=0;t76=0;t77=0;t78=0;
t80=0;t81=0;t82=0;t83=0;t84=0;
t93=0;t94=0;t95=0;t96=0;t97=0;
t106=0;t107=0;t108=0;t109=0;t110=0;
t119=0;t120=0;t121=0;t122=0;t123=0;
t132=0;t133=0;t134=0;t135=0;t136=0;
t145=0;t146=0;t147=0;t148=0;t149=0;
%initial condition

i=1;
while i<1000
t2=(1/6*t3)+(1/6*t1)+(1/3*t15)+(1/3*t0);
t3=(1/6*t4)+(1/6*t2)+(1/3*t16)+(1/3*t0);
t4=(1/6*t5)+(1/6*t3)+(1/3*t17)+(1/3*t0);
t5=(1/6*t6)+(1/6*t4)+(1/3*t18)+(1/3*t0);
t6=(1/6*t7)+(1/6*t5)+(1/3*t19)+(1/3*t0);
t7=(1/6*t8)+(1/6*t6)+(1/3*t20)+(1/3*t0);
t8=(1/6*t9)+(1/6*t7)+(1/3*t21)+(1/3*t0);
t9=(1/6*t10)+(1/6*t8)+(1/3*t22)+(1/3*t0);
t10=(1/6*t11)+(1/6*t9)+(1/3*t23)+(1/3*t0);
t11=(1/6*t12)+(1/6*t10)+(1/3*t24)+(1/3*t0);
t12=(1/6*t13)+(1/6*t11)+(1/3*t25)+(1/3*t0);
%Convection heat trasfer t_center=(1/6*t_right)+(1/6*t_left)+(1/3*t_down)+(1/3*t0)

t13=(t12+t26+t0)/3; % center=(left+down+convection)/3

t15=(t14+t16+t28+t2)/4;
t16=(t15+t17+t29+t3)/4;
t17=(t16+t18+t30+t4)/4;
t18=(t17+t19+t31+t5)/4;
t19=(t18+t20+t32+t6)/4;
t20=(t19+t21+t33+t7)/4;
t21=(t20+t22+t34+t8)/4;
t22=(t21+t23+t35+t9)/4;
t23=(t22+t24+t36+t10)/4;
t24=(t23+t25+t37+t11)/4;
t25=(t24+t26+t38+t12)/4;
%first line

t28=(t27+t29+t41+t15)/4;
t29=(t28+t30+t42+t16)/4;
t30=(t29+t31+t43+t17)/4;
t31=(t30+t32+t44+t18)/4;
t32=(t31+t33+t45+t19)/4;
t33=(t32+t34+t46+t20)/4;
t34=(t33+t35+t47+t21)/4;
t35=(t34+t36+t48+t22)/4;
t36=(t35+t37+t49+t23)/4;
t37=(t36+t38+t50+t24)/4;
t38=(t37+t39+t51+t25)/4;
%second line

t41=(t40+t42+t54+t28)/4;
t42=(t41+t43+t55+t29)/4;
t43=(t42+t44+t56+t30)/4;
t44=(t43+t45+t57+t31)/4;
t45=(t44+t46+t58+t32)/4;
t46=(t45+t47+t59+t33)/4;
t47=(t46+t48+t60+t34)/4;
t48=(t47+t49+t61+t35)/4;
t49=(t48+t50+t62+t36)/4;
t50=(t49+t51+t63+t37)/4;
t51=(t50+t52+t64+t38)/4;
%third line

t54=(t53+t55+t67+t41)/4;
t55=(t54+t56+t68+t42)/4;
t56=(t55+t57+t69+t43)/4;
t57=(t56+t58+t70+t44)/4;
t58=(t57+t59+t71+t45)/4;
t59=(t58+t60+t72+t46)/4;
t60=(t59+t61+t73+t47)/4;
t61=(t60+t62+t74+t48)/4;
t62=(t61+t63+t75+t49)/4;
t63=(t62+t64+t76+t50)/4;
t64=(t63+t65+t77+t51)/4;
%fourth line

t67=(t66+t68+t80+t54)/4;
t68=(t67+t69+t81+t55)/4;
t69=(t68+t70+t82+t56)/4;
t70=(t69+t71+t83+t57)/4;
t71=(t70+t72+t84+t58)/4;
t72=(t71+t73+t85+t59)/4;
t73=(t72+t74+t86+t60)/4;
t74=(t73+t75+t87+t61)/4;
t75=(t74+t76+t88+t62)/4;
t76=(t75+t77+t89+t63)/4;
t77=(t76+t78+t90+t64)/4;
%fifth line

t80=(t79+t81+t93+t67)/4;
t81=(t80+t82+t94+t68)/4;
t82=(t81+t83+t95+t69)/4;
t83=(t82+t84+t96+t70)/4;
t84=(t83+t85+t97+t71)/4;
%sixth line

t93=(t92+t94+t106+t80)/4;
t94=(t93+t95+t107+t81)/4;
t95=(t94+t96+t108+t82)/4;
t96=(t95+t97+t109+t83)/4;
t97=(t96+t98+t110+t84)/4;
%seventh line

t106=(t105+t107+t119+t93)/4;
t107=(t106+t108+t120+t94)/4;
t108=(t107+t109+t121+t95)/4;
t109=(t108+t110+t122+t96)/4;
t110=(t109+t111+t123+t97)/4;
%eightth line

t119=(t118+t120+t132+t106)/4;
t120=(t119+t121+t133+t107)/4;
t121=(t120+t122+t134+t108)/4;
t122=(t121+t123+t135+t109)/4;
t123=(t122+t124+t136+t110)/4;
%ninth line

t132=(t131+t133+t145+t119)/4;
t133=(t132+t134+t146+t120)/4;
t134=(t133+t135+t147+t121)/4;
t135=(t134+t136+t148+t122)/4;
t136=(t135+t137+t149+t123)/4;
%tenth line

t145=(t144+t146+t158+t132)/4;
t146=(t145+t147+t159+t133)/4;
t147=(t146+t148+t160+t134)/4;
t148=(t147+t149+t161+t135)/4;
t149=(t148+t150+t162+t136)/4;
%eleventh line
%4_surface conduction, t_center=(t_right+t_left+t_bottom+t_top)/4

t26=(t25)/2+(t39)/4+(t13)/4;
t39=(t38)/2+(t52)/4+(t26)/4;
t52=(t51)/2+(t65)/4+(t39)/4;
t65=(t64)/2+(t78)/4+(t52)/4;
t78=(t77)/2+(t91)/4+(t65)/4;
%Adiabatic surface, t_center=t_left/2+t_down/4+t_up/4

%Conduction heat transfer
    i=i+1;
end

T=[t1 t2 t3 t4 t5 t6 t7 t8 t9 t10 t11 t12 t13;...
    t14 t15 t16 t17 t18 t19 t20 t21 t22 t23 t24 t25 t26;...
    t27 t28 t29 t30 t31 t32 t33 t34 t35 t36 t37 t38 t39;...
    t40 t41 t42 t43 t44 t45 t46 t47 t48 t49 t50 t51 t52;...
    t53 t54 t55 t56 t57 t58 t59 t60 t61 t62 t63 t64 t65;...
    t66	t67	t68	t69	t70	t71	t72	t73	t74	t75	t76	t77	t78;...
   	t79	t80	t81	t82	t83	t84	t85	t86	t87	t88	t89	t90 t91;...
    t92	t93	t94	t95	t96	t97	t98	t99	t100 t101 t102 t103 t104;...
    t105 t106 t107 t108 t109 t110 t111 t112 t113 t114 t115 t116 t117;...
    t118 t119 t120 t121 t122 t123 t124 t125 t126 t127 t128 t129 t130;...
    t131 t132 t133 t134 t135 t136 t137 t138 t139 t140 t141 t142 t143;...
    t144 t145 t146 t147 t148 t149 t150 t151 t152 t153 t154 t155 t156;...
    t157 t158 t159 t160 t161 t162 t163 t164 t165 t166 t167 t168 t169];
%Index

x=(1:13);y=(1:13);
Z=T(x,y);
contour(Z,1000)

%heat transfer T_1=6 , in=plus ,out=minus q=kA(dT)/L
q1=0.5*(t1-t2);
q14=t14-t15;
q27=t27-t28;
q40=t40-t41;
q53=t53-t54; 
q66=t66-t67;
q79=t79-t80; 
q92=t92-t93;
q105=t105-t106;
q118=t118-t119; 
q131=t131-t132; 
q144=t144-t145;

q_T_1=q1+q14+q27+q40+q53+q66+q79+q92+q105+q118+q131+q144;

%heat transfer T_2=3 , in=plus ,out=minus q=kA(dT)/L
q158=t158-t145;
q159=t159-t146;
q160=t160-t147;
q161=t161-t148;
q162=t162-t149;
q150=t150-t149;
q137=t137-t136;
q124=t124-t123;
q111=t111-t110;
q98=t98-t97;
q85=t85-t84+t85-t72;
q86=t86-t73;
q87=t87-t74;
q88=t88-t75;
q89=t89-t76;
q90=t90-t77;
q91=0.5*(t91-t78);

q_T_2=q158+q159+q160+q161+q162+q150+q137+q124+q111...
+q98+q85+q86+q87+q88+q89+q90+q91;

%heat transfer convection q=hA(dt)
q2=t0-t2;
q3=t0-t3;
q4=t0-t4;
q5=t0-t5;
q6=t0-t6;
q7=t0-t7;
q8=t0-t8;
q9=t0-t9;
q10=t0-t10;
q11=t0-t11;
q12=t0-t12;
q13=0.5*(t0-t13);

q_T_0=q2+q3+q4+q5+q6+q7+q8+q9+q10+q11+q12+q13;

q_T_0 %대류를 통한 열전달(들어오는 방향)
q_T_1 %경계조건 T1을 통한 열전달(들어오는 방향)
q_T_2 %경계조건 T2를 통한 열전달(들어오는 방향)
q=q_T_0+q_T_1+q_T_2 %총 열전달q_T_0 